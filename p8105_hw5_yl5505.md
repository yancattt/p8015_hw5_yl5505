hw5
================
Yan Li
2024-11-13

# Problem 1

## Birthday Function

``` r
bday_dupes = function(n) {

  bdays = sample(1:365, size = n, replace = TRUE)
  
  has_dupe = any(duplicated(bdays))
  
  return(has_dupe)
}
```

## Run function for different group size

``` r
set.seed(123)
results = map_df(2:50, function(n) {
  dupes = map_lgl(1:10000, ~ bday_dupes(n))
  prob = mean(dupes)
  tibble(group_size = n, prob = prob)
})
```

## Plot

``` r
ggplot(results, aes(x = group_size, y = prob)) +
  geom_line() +
  labs(
    title = "Problem 1:Birthday Function",
    x = "Group Size",
    y = "Probability of Shared Birthday"
  )
```

<img src="p8105_hw5_yl5505_files/figure-gfm/unnamed-chunk-4-1.png" width="90%" /> -
The probability of shared birthday increases as the group size
increases, and the growth in probability is nonlinear.

# Problem 2

## t-test

``` r
set.seed(123)
n = 30
sigma = 5
mu_vals = 0:6

power_results = map_df(mu_vals, function(mu) {
  p_vals = map_dbl(1:5000, ~ {
    x = rnorm(n, mean = mu, sd = sigma)
    t_test = t.test(x, mu = 0)
    broom::tidy(t_test)$p.value
  })
  power = mean(p_vals < 0.05)
  tibble(mu = mu, power = power)
})

power_results
```

    ## # A tibble: 7 Ã— 2
    ##      mu  power
    ##   <int>  <dbl>
    ## 1     0 0.0446
    ## 2     1 0.191 
    ## 3     2 0.556 
    ## 4     3 0.890 
    ## 5     4 0.987 
    ## 6     5 0.999 
    ## 7     6 1
